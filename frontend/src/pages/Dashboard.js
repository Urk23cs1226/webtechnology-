import React, { useEffect, useState } from 'react'; import API from '../api/api'; export default function Dashboard({ user }){ const [wastes,setWastes]=useState([]); const [type,setType]=useState('Plastic'); const [quantity,setQuantity]=useState(1); const [location,setLocation]=useState(''); useEffect(()=>{ API.get('/waste').then(r=>setWastes(r.data)).catch(()=>{}); },[]); const submit = async e=>{ e.preventDefault(); try{ await API.post('/waste',{ type, quantity, location }); const r = await API.get('/waste'); setWastes(r.data); setType('Plastic'); setQuantity(1); setLocation(''); }catch(err){ alert(err?.response?.data?.error || 'Add failed'); } }; return (<div><h2>Dashboard</h2>{user? <p>Welcome, {user.name} ({user.role})</p>: <p>Please login.</p>}<h3>Add Collection</h3><form className='form' onSubmit={submit}><select value={type} onChange={e=>setType(e.target.value)}><option>Plastic</option><option>Paper</option><option>Metal</option></select><input type='number' value={quantity} onChange={e=>setQuantity(e.target.value)} /><input placeholder='Location' value={location} onChange={e=>setLocation(e.target.value)} /><button className='button'>Add</button></form><h3>All Records</h3>{wastes.map(w=>(<div key={w._id} className='list-item'>{w.type} - {w.quantity}kg at {w.location}</div>))}</div>); }