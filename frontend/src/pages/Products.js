import React, { useEffect, useState } from 'react'; import API from '../api/api'; export default function Products({ user }){ const [products,setProducts]=useState([]); const [name,setName]=useState(''); const [price,setPrice]=useState(0); useEffect(()=>{ API.get('/products').then(r=>setProducts(r.data)).catch(()=>{}); },[]); const add = async ()=>{ try{ await API.post('/products',{ name, price, stock:10, description:'' }); const r = await API.get('/products'); setProducts(r.data); setName(''); setPrice(0);}catch(err){ alert(err?.response?.data?.error || 'Add failed'); } }; return (<div><h2>Products</h2><div>{products.map(p=>(<div key={p._id} className='list-item'>{p.name} - ${p.price}</div>))}</div>{user && user.role==='admin' && <div><h3>Add Product</h3><input value={name} onChange={e=>setName(e.target.value)} placeholder='Name' /><input value={price} onChange={e=>setPrice(e.target.value)} placeholder='Price' /><button className='button' onClick={add}>Add</button></div>}</div>); }